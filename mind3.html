<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MindNote Demo</title>
    <style>
        body { 
            margin: 0; 
            overflow: hidden; 
            font-family: Arial, sans-serif;
            background-color: #000011;
        }
        #noteInput {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            padding: 10px;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            font-size: 24px;
            transition: all 0.3s ease;
            z-index: 1000;
        }
        #noteInput.active {
            width: 300px;
            height: auto;
            border-radius: 10px;
        }
        #noteInput.active #addButton { display: none; }
        #noteForm { display: none; }
        #noteInput.active #noteForm { display: block; }
        input, textarea, button {
            display: block;
            margin-bottom: 5px;
            width: 100%;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.5);
            color: white;
            padding: 5px;
        }
        button { cursor: pointer; }
        ::placeholder { color: rgba(255, 255, 255, 0.7); }
        #notesContainer {
            position: fixed;
            top: 10px;
            left: 10px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        .note-card {
            width: 150px;
            height: 50px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            padding: 10px;
            cursor: move;
            font-size: 14px;
            color: white;
            transition: all 0.3s ease;
            overflow: hidden;
            position: relative;
        }
        .note-card .title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .note-card .content {
            display: none;
            font-size: 12px;
        }
        .note-card.expanded {
            width: 300px;
            height: 200px;
            background: rgba(255, 255, 255, 0.8);
            color: black;
            z-index: 100;
        }
        .note-card.expanded .content {
            display: block;
        }
        .delete-button {
            position: absolute;
            top: 5px;
            right: 5px;
            background: none;
            border: none;
            color: white;
            font-size: 16px;
            cursor: pointer;
            display: none;
        }
        .note-card:hover .delete-button,
        .note-card.expanded .delete-button {
            display: block;
        }
        .note-card.expanded .delete-button {
            color: black;
        }
        /* Position the Three.js canvas behind other elements */
        canvas {
            position: fixed;
            top: 0;
            left: 0;
            z-index: -1;
        }
    </style>
</head>
<body>
    <div id="noteInput">
        <div id="addButton">➕</div>
        <div id="noteForm">
            <input type="text" id="noteTitle" placeholder="Title">
            <textarea id="noteContent" placeholder="Content" rows="3"></textarea>
            <button id="addNoteButton">Add Note</button>
        </div>
    </div>
    <div id="notesContainer"></div>

    <!-- Include Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- Include GSAP if needed -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script> -->
    <script>
        // Array to store notes
        let notes = [];
        
        // Variable to store the currently dragged note element
        let draggedElement = null;
        
        // Object to store the offset position of the mouse from the top-left corner of the dragged element
        let offset = { x: 0, y: 0 };

        // Variables for Three.js
        // Three.js is a JavaScript library that makes creating 3D graphics on the web easy
        let scene, camera, renderer, stars = [];

        // Initialize the app by calling the init function
        function init() {
            initThreeJS();
            addEventListeners();
        }

        // Function to initialize Three.js
        function initThreeJS() {
            // Create a new Three.js scene
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x000011); // Set the background color of the scene

            // Create a camera with a perspective view
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 30; // Position the camera

            // Create a WebGL renderer and set its size
            // WebGL is a JavaScript API for rendering interactive 2D and 3D graphics within any compatible web browser
            // anti-aliasing is a technique used to smooth out jagged edges in digital images
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement); // Append the renderer to the document

            // Add ambient light to the scene
            // Ambient light is a light source that affects all objects in the scene equally
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.2);
            scene.add(ambientLight);

            // Add a point light to the scene
            // Point light is a light source that emits light in all directions from a point in space
            const pointLight = new THREE.PointLight(0xffffff, 0.8);
            pointLight.position.set(50, 50, 50);
            scene.add(pointLight);

            // Add stars to the scene
            addStars();

            // Add an event listener to handle window resize
            window.addEventListener('resize', onWindowResize);

            // Start the animation loop
            animate();
        }

        // Function to add stars to the Three.js scene
        function addStars() {
            // Create a sphere geometry for the stars with radius 0.1 and 24 segments
            // A sphere is a 3D geometrical object that is perfectly round in shape
            const geometry = new THREE.SphereGeometry(0.1, 24, 24);
            
            // Array of colors for the stars
            const colors = [0xADD8E6, 0x90EE90, 0xF5F5DC, 0xFFC0CB]; // Light-blue, light-green, beige, pink

            // Loop to create 1000 stars
            for (let i = 0; i < 1000; i++) {
            // Randomly select a color for the star
            const color = colors[Math.floor(Math.random() * colors.length)];
            
            // Create a material for the star with the selected color
            // MeshBasicMaterial is a material for drawing geometries in a simple shaded (flat or wireframe) way
            const material = new THREE.MeshBasicMaterial({ color: color });
            
            // Create a mesh for the star using the geometry and material
            // Mesh is a class that is used to create a 3D object by combining a geometry and a material
            const star = new THREE.Mesh(geometry, material);
            
            // Randomly 3D position the star within a 100x100x100 cube
            const [x, y, z] = Array(3).fill().map(() => THREE.MathUtils.randFloatSpread(100));
            star.position.set(x, y, z);
            
            // Add the star to the scene
            scene.add(star);
            
            // Add the star to the stars array for later use
            stars.push(star);
            }
        }

        // Function to animate the scene
        function animate() {
            // Request the next frame of the animation
            requestAnimationFrame(animate);

            // Update the position of each star
            stars.forEach(star => {
            star.position.z += 0.01; // Move the star along the z-axis (depth) at a slow speed
            if (star.position.z > 50) star.position.z = -50; // Reset the star's position if it goes too far
            });

            // Render the scene from the perspective of the camera
            renderer.render(scene, camera);
        }

        // Function to handle window resize events
        function onWindowResize() {
            // Update the camera's aspect ratio to match the new window size
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();

            // Update the renderer's size to match the new window size
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function addEventListeners() {
            // Add click event listener to the add button to activate the note input form
            document.getElementById('addButton').addEventListener('click', () => {
            document.getElementById('noteInput').classList.add('active');
            });

            // Add click event listener to the add note button to add a new note
            document.getElementById('addNoteButton').addEventListener('click', addNote);

            // Add click event listener to the document to deactivate the note input form when clicking outside of it
            document.addEventListener('click', (event) => {
            const noteInput = document.getElementById('noteInput');
            if (!noteInput.contains(event.target) && noteInput.classList.contains('active')) {
                noteInput.classList.remove('active');
            }
            });

            // Add mouse event listeners for dragging notes
            document.addEventListener('mousedown', onMouseDown);
            document.addEventListener('mousemove', onMouseMove);
            document.addEventListener('mouseup', onMouseUp);
        }

        // Function to add a new note
        function addNote() {
            // Get the title and content from the input fields
            const title = document.getElementById('noteTitle').value;
            const content = document.getElementById('noteContent').value;

            // Check if both title and content are provided
            if (title && content) {
            // Create a new note object
            const note = { title, content };

            // Add the note to the notes array
            notes.push(note);

            // Create a new note card and add it to the DOM
            createNoteCard(note);

            // Clear the input fields
            document.getElementById('noteTitle').value = '';
            document.getElementById('noteContent').value = '';

            // Deactivate the note input form
            document.getElementById('noteInput').classList.remove('active');
            } else {
            // Alert the user if title or content is missing
            alert('Please enter both title and content for the note.');
            }
        }

        function createNoteCard(note) {
            // 創建一個新的 div 元素作為筆記卡片
            const noteCard = document.createElement('div');
            // 設置筆記卡片的 class 名稱
            noteCard.className = 'note-card';
            // 設置筆記卡片的內部 HTML 結構，包括標題、內容和刪除按鈕
            noteCard.innerHTML = `
                <div class="title">${note.title}</div>
                <div class="content">${note.content}</div>
                <button class="delete-button">🗑️</button>
            `;
            // 為筆記卡片添加雙擊事件監聽器，用於切換展開狀態
            noteCard.addEventListener('dblclick', () => toggleExpand(noteCard));
            // 為刪除按鈕添加點擊事件監聽器，防止事件冒泡並刪除筆記卡片
            noteCard.querySelector('.delete-button').addEventListener('click', (e) => {
                e.stopPropagation();
                deleteNote(noteCard);
            });
            // 將筆記卡片添加到 ID 為 'notesContainer' 的元素中
            document.getElementById('notesContainer').appendChild(noteCard);
        }

        // Function to toggle the expand state of a note card
        function toggleExpand(noteCard) {
            noteCard.classList.toggle('expanded');
        }

        // Function to delete a note card
        function deleteNote(noteCard) {
            noteCard.remove();
            // Optionally remove the note from the 'notes' array
        }

        // Function to handle mouse down (按下滑鼠) events
        function onMouseDown(e) {
            // Find the closest note card element to the event target
            const noteCard = e.target.closest('.note-card');
            // Check if a note card was found and the event target is not the delete button
            if (noteCard && !e.target.classList.contains('delete-button')) {
            // Set the dragged element to the note card
            draggedElement = noteCard;
            // Calculate the offset of the mouse position from the top-left corner of the note card
            offset.x = e.clientX - noteCard.getBoundingClientRect().left;
            offset.y = e.clientY - noteCard.getBoundingClientRect().top;
            // Set the z-index of the note card to bring it to the front
            noteCard.style.zIndex = 1000;
            }
        }

        // Function to handle mouse move events
        function onMouseMove(e) {
            // Check if there is a dragged element
            if (draggedElement) {
            // Calculate the new position of the dragged element
            const x = e.clientX - offset.x;
            const y = e.clientY - offset.y;
            // Update the position of the dragged element
            draggedElement.style.left = `${x}px`;
            draggedElement.style.top = `${y}px`;
            draggedElement.style.position = 'fixed';
            }
        }

        // Function to handle mouse up (釋放滑鼠) events
        function onMouseUp() {
            // Check if there is a dragged element
            if (draggedElement) {
            // Reset the z-index of the dragged element
            draggedElement.style.zIndex = '';
            // Clear the dragged element
            draggedElement = null;
            }
        }

        init();
    </script>
</body>
</html>
